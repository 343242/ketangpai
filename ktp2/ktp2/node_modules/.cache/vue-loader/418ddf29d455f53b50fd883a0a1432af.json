{"remainingRequest":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\src\\views\\Task\\StudentTaskCommit.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\src\\views\\Task\\StudentTaskCommit.vue","mtime":1592550844000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcycKaW1wb3J0IFRhc2tDb21taXROYXYgZnJvbSAnY29tcG9uZW50cy9jb250ZW50L1Rhc2tDb21taXROYXYnCmltcG9ydCB7cmVxdWVzdH0gZnJvbSAnLi4vLi4vbmV0d29yay9yZXF1ZXN0JwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlRhc2tDb21taXQiLAogIGNvbXBvbmVudHM6IHsKICAgIFRhc2tDb21taXROYXYKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjb3Vyc2U6IHt9LAogICAgICB0YXNrOiB7fSwKICAgICAgZ3JhZGU6IHt9LAogICAgICByZW5kZXJLZXk6IGZhbHNlLAogICAgICBlbmRfZGF0ZTogJycsCiAgICAgIGFuc3dlcjogJycsCiAgICAgIGlzRGlzYWJsZWQ6IHRydWUsCiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgY29uc3QgY291cnNlQ29uZmlnID0gcmVxdWVzdCh7CiAgICAgIHVybDogJy9hcGkvY291cnNlL2dldENvdXJzZUJ5Q25vJywKICAgICAgbWV0aG9kOiAnZ2V0JywKICAgICAgcGFyYW1zOiB7CiAgICAgICAgY25vOiB0aGlzLiRyb3V0ZS5wYXJhbXMuY25vCiAgICAgIH0KICAgIH0pCgogICAgY29uc3QgdGFza0NvbmZpZyA9IHJlcXVlc3QoewogICAgICB1cmw6ICcvYXBpL3Rhc2tMaXN0JywKICAgICAgbWV0aG9kOiAnZ2V0JywKICAgICAgcGFyYW1zOiB7CiAgICAgICAgdG5vOiB0aGlzLiRyb3V0ZS5wYXJhbXMudG5vLAogICAgICAgIGNubzogdGhpcy4kcm91dGUucGFyYW1zLmNubwogICAgICB9CiAgICB9KQoKICAgIGNvbnN0IGdyYWRlQ29uZmlnID0gcmVxdWVzdCh7CiAgICAgIHVybDogJy9hcGkvZ3JhZGUvZ2V0R3JhZGUnLAogICAgICBtZXRob2Q6ICdnZXQnLAogICAgICBwYXJhbXM6IHsKICAgICAgICB1aWQ6IHRoaXMuJHN0b3JlLnN0YXRlLnVpZCwKICAgICAgICB0bm86IHRoaXMuJHJvdXRlLnBhcmFtcy50bm8KICAgICAgfQogICAgfSkKCiAgICBheGlvcy5hbGwoW2NvdXJzZUNvbmZpZywgdGFza0NvbmZpZywgZ3JhZGVDb25maWddKQogICAgLnRoZW4oYXhpb3Muc3ByZWFkKChyZXMxLCByZXMyLCByZXMzKSA9PiB7CiAgICAgIHRoaXMuY291cnNlID0gcmVzMS5kYXRhCiAgICAgIHRoaXMudGFzayA9IHJlczIuZGF0YVswXQogICAgICB0aGlzLmdyYWRlID0gcmVzMy5kYXRhCiAgICAgIHRoaXMucmVuZGVyS2V5ID0gdHJ1ZQogICAgICB0aGlzLmFuc3dlciA9IHRoaXMuZ3JhZGUuYW5zd2VyCiAgICAgIHRoaXMuaXNEaXNhYmxlZCA9IHRoaXMuYW5zd2VyID09ICcnCiAgICB9KSkuY2F0Y2goZXJyID0+IHtjb25zb2xlLmxvZyhlcnIpfSkKICB9LAogIG1ldGhvZHM6IHsKICAgIHN1Ym1pdCgpIHsKICAgICAgcmVxdWVzdCh7CiAgICAgICAgdXJsOiAnL2FwaS9ncmFkZS9zdWJtaXQnLAogICAgICAgIG1ldGhvZDogJ3B1dCcsCiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICB1aWQ6IHRoaXMuJHN0b3JlLnN0YXRlLnVpZCwKICAgICAgICAgIHRubzogdGhpcy50YXNrLnRubywKICAgICAgICAgIGFuc3dlcjogdGhpcy5hbnN3ZXIKICAgICAgICB9CiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLmRhdGEpIHsKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKGAvc3R1ZGVudHRhc2svJHt0aGlzLmNvdXJzZS5jbm99YCkKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5o+Q5Lqk5oiQ5YqfJykKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5o+Q5Lqk5aSx6LSl77yM6K+36YeN6K+VJykKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGVyciA9PiB7Y29uc29sLmxvZyhlcnIpfSkKICAgIH0sCiAgICBjYW5EaXNhYmxlZCgpIHsKICAgICAgdGhpcy5pc0Rpc2FibGVkID0gdGhpcy5hbnN3ZXIgPT0gJycKICAgIH0sCiAgICBkYXRlX2Zvcm1hdChkYXRlKSB7CiAgICByZXR1cm4gbmV3IERhdGUoZGF0ZSkuZm9ybWF0KCJ5eS9NTS9kZCIpOwogICAgfSwKICAgIHRpbWVfZm9ybWF0KGRhdGUpIHsKICAgICAgcmV0dXJuIG5ldyBEYXRlKGRhdGUpLmZvcm1hdCgiaGg6bW0iKTsKICAgIH0sCiAgICBiYWNrKCkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaChgL3N0dWRlbnR0YXNrLyR7dGhpcy5jb3Vyc2UuY25vfWApCiAgICB9CiAgfSwKICAKfQo="},{"version":3,"sources":["StudentTaskCommit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"StudentTaskCommit.vue","sourceRoot":"src/views/Task","sourcesContent":["<template>\r\n  <div class=\"wrapper\" v-if=\"this.renderKey\">\r\n    <task-commit-nav \r\n      :cname=\"course.name\" \r\n      :tno=\"task.tno\"\r\n      :cno=\"course.cno\"\r\n      @back=\"back\" />\r\n    <div class=\"task-info\">\r\n      <div class=\"task-head\">\r\n        <div class=\"task-title\">\r\n          <span>{{ task.tname }}</span>\r\n        </div>\r\n        <div class=\"task-word\">\r\n          <span v-html=\"task.description\"></span>\r\n        </div>\r\n      </div>\r\n      <div class=\"task-props\">\r\n        <span>截止日期：{{ date_format(task.endDate) }} {{time_format(task.endDate)}}</span>\r\n        <span>个人作业</span>\r\n      </div>\r\n    </div>\r\n    <div class=\"submit\">\r\n      <el-button style=\"width: 102px;\" type=\"primary\" :disabled=\"isDisabled\" plain @click=\"submit\">{{grade.score == -1 ? '提交' : '更新提交'}}</el-button>\r\n      <span style=\"float: right\">{{ grade.score == -1 ? \"未完成\":\"已提交\" }}</span>\r\n    </div>\r\n    <div class=\"work-text\">\r\n      <span>答：</span>\r\n      <el-input\r\n        style=\"width: 97%;float: right\"\r\n        type=\"textarea\"\r\n        :autosize=\"{ minRows: 5 }\"\r\n        placeholder=\"点击编辑作业内容（仅老师可看）...\"\r\n        @input=\"canDisabled\"\r\n        v-model=\"answer\">\r\n      </el-input>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import axios from 'axios'\r\n  import TaskCommitNav from 'components/content/TaskCommitNav'\r\n  import {request} from '../../network/request'\r\n  export default {\r\n    name: \"TaskCommit\",\r\n    components: {\r\n      TaskCommitNav\r\n    },\r\n    data() {\r\n      return {\r\n        course: {},\r\n        task: {},\r\n        grade: {},\r\n        renderKey: false,\r\n        end_date: '',\r\n        answer: '',\r\n        isDisabled: true,\r\n      }\r\n    },\r\n    mounted() {\r\n      const courseConfig = request({\r\n        url: '/api/course/getCourseByCno',\r\n        method: 'get',\r\n        params: {\r\n          cno: this.$route.params.cno\r\n        }\r\n      })\r\n\r\n      const taskConfig = request({\r\n        url: '/api/taskList',\r\n        method: 'get',\r\n        params: {\r\n          tno: this.$route.params.tno,\r\n          cno: this.$route.params.cno\r\n        }\r\n      })\r\n\r\n      const gradeConfig = request({\r\n        url: '/api/grade/getGrade',\r\n        method: 'get',\r\n        params: {\r\n          uid: this.$store.state.uid,\r\n          tno: this.$route.params.tno\r\n        }\r\n      })\r\n\r\n      axios.all([courseConfig, taskConfig, gradeConfig])\r\n      .then(axios.spread((res1, res2, res3) => {\r\n        this.course = res1.data\r\n        this.task = res2.data[0]\r\n        this.grade = res3.data\r\n        this.renderKey = true\r\n        this.answer = this.grade.answer\r\n        this.isDisabled = this.answer == ''\r\n      })).catch(err => {console.log(err)})\r\n    },\r\n    methods: {\r\n      submit() {\r\n        request({\r\n          url: '/api/grade/submit',\r\n          method: 'put',\r\n          params: {\r\n            uid: this.$store.state.uid,\r\n            tno: this.task.tno,\r\n            answer: this.answer\r\n          }\r\n        }).then(res => {\r\n          if (res.data) {\r\n            this.$router.push(`/studenttask/${this.course.cno}`)\r\n            this.$message.success('提交成功')\r\n          } else {\r\n            this.$message.error('提交失败，请重试')\r\n          }\r\n        }).catch(err => {consol.log(err)})\r\n      },\r\n      canDisabled() {\r\n        this.isDisabled = this.answer == ''\r\n      },\r\n      date_format(date) {\r\n      return new Date(date).format(\"yy/MM/dd\");\r\n      },\r\n      time_format(date) {\r\n        return new Date(date).format(\"hh:mm\");\r\n      },\r\n      back() {\r\n        this.$router.push(`/studenttask/${this.course.cno}`)\r\n      }\r\n    },\r\n    \r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  .wrapper {\r\n    width: 83%;\r\n    margin: auto;\r\n    font-size: 14px;\r\n    font-family: 'PingFang SC',tahoma,arial,'helvetica neue','hiragino sans gb','microsoft yahei ui','microsoft yahei',simsun,sans-serif;\r\n  }\r\n  .task-info {\r\n    padding-top: 100px;\r\n  }\r\n  .submit {\r\n    margin-top: 40px;\r\n  }\r\n  .task-title {\r\n    font-size: 18px;\r\n  }\r\n  .task-word {\r\n    font-size: 12px;\r\n    margin-top: 14px;\r\n    color: #5F6368;\r\n  }\r\n  .task-props {\r\n    margin-top: 30px;\r\n  }\r\n  .task-props span{\r\n    background-color: #F1F3F4;\r\n    font-size: 12px;\r\n    color: #5F6368;\r\n    padding: 3px 5px;\r\n    margin-right: 10px;\r\n  }\r\n  .work-text {\r\n    margin-top: 20px;\r\n  }\r\n</style>\r\n"]}]}