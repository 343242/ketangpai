{"remainingRequest":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\src\\views\\Discuss\\Discuss.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\src\\views\\Discuss\\Discuss.vue","mtime":1592742808964},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBUYXNrQ29tbWl0TmF2IGZyb20gJ2NvbXBvbmVudHMvY29udGVudC9UYXNrQ29tbWl0TmF2JwppbXBvcnQge3JlcXVlc3R9IGZyb20gJy4uLy4uL25ldHdvcmsvcmVxdWVzdCcKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdEaXNjdXNzJywKICBjb21wb25lbnRzOiB7CiAgICBUYXNrQ29tbWl0TmF2CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdGV4dGFyZWE6ICIiLAogICAgICB0YXNrOiB7fSwKICAgICAgLy8g6K+E6K66CiAgICAgIGNvbW1lbnRzOiBbXSwKICAgICAgY291cnNlOiB7fSwKICAgICAgYXZhdGFyOiAgcmVxdWlyZSgnLi4vLi4vYXNzZXRzL2F2YXRhci8nICsgdGhpcy4kc3RvcmUuc3RhdGUuYXZhdGFyKQogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIGNvbnN0IGNvbW1lbnRDb25maWcgPSByZXF1ZXN0KHsKICAgICAgdXJsOiAnL2FwaS90YXNrL2dldENvbW1lbnRzJywKICAgICAgbWV0aG9kOiAnZ2V0JywKICAgICAgcGFyYW1zOiB7CiAgICAgICAgdG5vOiB0aGlzLiRyb3V0ZS5wYXJhbXMudG5vCiAgICAgIH0KICAgIH0pCiAgICBjb25zdCBjb3Vyc2VDb25maWcgPSByZXF1ZXN0KHsKICAgICAgdXJsOiAnL2FwaS9jb3Vyc2UvZ2V0Q291cnNlQnlDbm8nLAogICAgICBtZXRob2Q6ICdnZXQnLAogICAgICBwYXJhbXM6IHsKICAgICAgICBjbm86IHRoaXMuJHJvdXRlLnBhcmFtcy5jbm8KICAgICAgfQogICAgfSkKICAgIGNvbnN0IHRhc2tDb25maWcgPSByZXF1ZXN0KHsKICAgICAgdXJsOiAnL2FwaS90YXNrTGlzdCcsCiAgICAgIG1ldGhvZDogJ2dldCcsCiAgICAgIHBhcmFtczogewogICAgICAgIGNubzogdGhpcy4kcm91dGUucGFyYW1zLmNubywKICAgICAgICB0bm86IHRoaXMuJHJvdXRlLnBhcmFtcy50bm8KICAgICAgfQogICAgfSkKCiAgICAvLyDlj6rmnInkuInkuKror7fmsYLpg73lj5HpgIHlrozmiJDlkI7vvIzmiY3kvJrmnInov5Tlm54KICAgIGF4aW9zLmFsbChbY29tbWVudENvbmZpZywgY291cnNlQ29uZmlnLCB0YXNrQ29uZmlnXSkKICAgICAgLnRoZW4oYXhpb3Muc3ByZWFkKChyZXMxLCByZXMyLCByZXMzKSA9PiB7CiAgICAgICAgdGhpcy5jb3Vyc2UgPSByZXMyLmRhdGEKICAgICAgICB0aGlzLnRhc2sgPSByZXMzLmRhdGFbMF0KICAgICAgICB0aGlzLmNvbW1lbnRzID0gcmVzMS5kYXRhCiAgICAgIH0pKS5jYXRjaChlcnIgPT4ge2NvbnNvbGUubG9nKGVycil9KQogIH0sCiAgbWV0aG9kczp7CiAgICBjcmVhdGVDb21tZW50KCl7CiAgICAgIGxldCBpdGVtID0gewogICAgICAgIHRhc2s6IHt0bm86IHRoaXMuJHJvdXRlLnBhcmFtcy50bm99LAogICAgICAgIHVzZXI6IHt1c2VySWQ6IHRoaXMuJHN0b3JlLnN0YXRlLnVpZH0sCiAgICAgICAgY29tbWVudDogdGhpcy50ZXh0YXJlYSwKICAgICAgfQoKICAgICAgcmVxdWVzdCh7CiAgICAgICAgdXJsOiAnL2FwaS90YXNrL2NvbW1lbnQnLAogICAgICAgIG1ldGhvZDogJ3Bvc3QnLAogICAgICAgIGRhdGE6IGl0ZW0KICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIC8vIOaPkuWFpeaIkOWKn++8jOmHjeaWsOivt+axggogICAgICAgIGlmIChyZXMuZGF0YSkgewogICAgICAgICAgcmVxdWVzdCh7CiAgICAgICAgICAgIHVybDogJy9hcGkvdGFzay9nZXRDb21tZW50cycsCiAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsCiAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgIHRubzogdGhpcy4kcm91dGUucGFyYW1zLnRubwogICAgICAgICAgICB9CiAgICAgICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgIHRoaXMuY29tbWVudHMgPSByZXMuZGF0YQogICAgICAgICAgICB0aGlzLnRleHRhcmVhPSIiCiAgICAgICAgICB9KS5jYXRjaChlcnIgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpCiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyID0+IHtjb25zb2xlLmxvZyhlcnIpfSkKICAgIH0sCiAgICBkYXRlX2Zvcm1hdChkYXRlKSB7CiAgICAgIHJldHVybiBuZXcgRGF0ZShkYXRlKS5mb3JtYXQoInl5L01NL2RkIik7CiAgICB9LAogICAgdGltZV9mb3JtYXQoZGF0ZSkgewogICAgICByZXR1cm4gbmV3IERhdGUoZGF0ZSkuZm9ybWF0KCJoaDptbSIpOwogICAgfSwKICAgIGJhY2soKSB7CiAgICAgIGlmICh0aGlzLiRzdG9yZS5zdGF0ZS5wZXJtaXNzaW9uID09ICcyJykgewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKGAvdGVhY2hlcnRhc2svJHt0aGlzLiRyb3V0ZS5wYXJhbXMuY25vfWApCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goYC9zdHVkZW50dGFzay8ke3RoaXMuJHJvdXRlLnBhcmFtcy5jbm99YCkKICAgICAgfQoKICAgIH0KICB9Cn0K"},{"version":3,"sources":["Discuss.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiDA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Discuss.vue","sourceRoot":"src/views/Discuss","sourcesContent":["<template>\n  <div class=\"outer\">\n    <task-commit-nav :cname=\"course.name\" @back=\"back\" />\n    <div>\n      <div class=\"content\">\n        <ul>\n          <div slot=\"header\" class=\"clearfix\">\n            <div>\n              <span style=\"float: left\"><h2>作业: {{task.tname}}</h2></span>\n            </div>\n          </div>\n          <div class=\"text item\" style=\" color: #A0A0A0;\">\n            课程: {{course.name}}\n          </div>\n          <el-divider></el-divider>\n          <div class=\"comment-box\">\n          <span>\n            <div><img :src=\"avatar\" /></div>\n          </span>\n            <el-input\n              type=\"textarea\"\n              :rows=\"5\"\n              style=\"position: relative;left: 90px; width:680px;padding-right: 300px\"\n              placeholder=\"添加评论\"\n              v-model=\"textarea\">\n            </el-input>\n            <div style=\"width: 100% ;height: 50px\">\n              <el-button @click=\"createComment()\" :disabled=\"textarea==''\" style=\"float: right;margin-right: 20px;margin-top: 20px\" type=\"primary\">确定</el-button>\n            </div>\n          </div>\n          <el-divider ></el-divider>\n          <li v-for=\"item in comments\">\n            <div>\n              <div><img :src=\"require('../../assets/avatar/' + item.user.avatar)\" /></div>\n              <div class=\"text item\">{{item.user.name}} {{item.user.userId}}<span style=\"color: #a9a9a9;padding-left: 10px\">{{date_format(item.cmDate)}} {{time_format(item.cmDate)}}</span>\n              </div>\n            </div>\n            <div class=\"text item\">{{item.comment}}</div>\n            <el-divider></el-divider>\n          </li>\n        </ul>\n      </div>\n    </div>\n\n  </div>\n\n</template>\n\n<script>\n  import TaskCommitNav from 'components/content/TaskCommitNav'\n  import {request} from '../../network/request'\n  import axios from 'axios'\n\n  export default {\n    name: 'Discuss',\n    components: {\n      TaskCommitNav\n    },\n    data() {\n      return {\n        textarea: \"\",\n        task: {},\n        // 评论\n        comments: [],\n        course: {},\n        avatar:  require('../../assets/avatar/' + this.$store.state.avatar)\n      }\n    },\n    mounted() {\n      const commentConfig = request({\n        url: '/api/task/getComments',\n        method: 'get',\n        params: {\n          tno: this.$route.params.tno\n        }\n      })\n      const courseConfig = request({\n        url: '/api/course/getCourseByCno',\n        method: 'get',\n        params: {\n          cno: this.$route.params.cno\n        }\n      })\n      const taskConfig = request({\n        url: '/api/taskList',\n        method: 'get',\n        params: {\n          cno: this.$route.params.cno,\n          tno: this.$route.params.tno\n        }\n      })\n\n      // 只有三个请求都发送完成后，才会有返回\n      axios.all([commentConfig, courseConfig, taskConfig])\n        .then(axios.spread((res1, res2, res3) => {\n          this.course = res2.data\n          this.task = res3.data[0]\n          this.comments = res1.data\n        })).catch(err => {console.log(err)})\n    },\n    methods:{\n      createComment(){\n        let item = {\n          task: {tno: this.$route.params.tno},\n          user: {userId: this.$store.state.uid},\n          comment: this.textarea,\n        }\n\n        request({\n          url: '/api/task/comment',\n          method: 'post',\n          data: item\n        }).then(res => {\n          // 插入成功，重新请求\n          if (res.data) {\n            request({\n              url: '/api/task/getComments',\n              method: 'get',\n              params: {\n                tno: this.$route.params.tno\n              }\n            }).then(res => {\n              this.comments = res.data\n              this.textarea=\"\"\n            }).catch(err => {\n              console.log(err)\n            })\n          }\n        }).catch(err => {console.log(err)})\n      },\n      date_format(date) {\n        return new Date(date).format(\"yy/MM/dd\");\n      },\n      time_format(date) {\n        return new Date(date).format(\"hh:mm\");\n      },\n      back() {\n        if (this.$store.state.permission == '2') {\n          this.$router.push(`/teachertask/${this.$route.params.cno}`)\n        } else {\n          this.$router.push(`/studenttask/${this.$route.params.cno}`)\n        }\n\n      }\n    }\n  }\n</script>\n\n<style scoped>\n  .outer {\n    width: 100%;\n  }\n\n  .outer>div {\n    width: 95%;\n  }\n\n  .content {\n    padding-top: 100px;\n    width: 810px;\n    margin-left: auto;\n    margin-right: auto;\n  }\n\n  .text {\n    font-size: 14px;\n  }\n\n  .item {\n    margin-bottom: 18px;\n    padding-left: 90px;\n  }\n\n  .clearfix:before,\n  .clearfix:after {\n    display: table;\n    content: \"\";\n  }\n\n\n  .clearfix:after {\n    clear: both\n  }\n\n  .clearfix {\n    margin-top: 30px;\n    margin-bottom: 18px;\n    padding: 0 20px 10px 30px;\n  }\n  .comment-box img{\n    width: 37px;\n    height: 37px;\n    position: relative;\n    float: left;\n    top:40px;\n    margin-right: 18px;\n    margin-top: 10px;\n  }\n\n  li {\n    list-style: none;\n  }\n\n  img {\n    width: 37px;\n    height: 37px;\n    position: relative;\n    float: left;\n    margin-left: 38px;\n    margin-top: -5px;\n    border-radius: 50%;\n  }\n\n\n  h2 {\n    padding-top: 10px;\n    float: left;\n    height: 50px;\n    line-height: 50px;\n    font-size: 20px;\n    font-weight: bold;\n    width: 100%;\n  }\n</style>\n"]}]}