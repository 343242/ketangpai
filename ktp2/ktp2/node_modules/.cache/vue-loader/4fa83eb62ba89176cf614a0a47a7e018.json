{"remainingRequest":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\src\\components\\content\\PersonalDeliver.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\src\\components\\content\\PersonalDeliver.vue","mtime":1592635432000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBFZGl0b3IgZnJvbSAiQC9jb21wb25lbnRzL2NvbnRlbnQvRWRpdG9yIjsKCiAgZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogIlBlcnNvbmFsRGVsaXZlciIsCiAgICBjb21wb25lbnRzOiB7RWRpdG9yfSwKICAgIHByb3BzOiB7CiAgICAgIGVkaXQ6IHsKICAgICAgICB0eXBlOkJvb2xlYW4sCiAgICAgICAgZGVmYXVsdDpmYWxzZQogICAgICB9LAogICAgICB0YXNrOiB7CiAgICAgICAgdHlwZTpPYmplY3QKICAgICAgfSwKICAgICAgY25vOiB7CiAgICAgICAgdHlwZTogU3RyaW5nCiAgICAgIH0KICAgIH0sCiAgICBkYXRhKCkgewogICAgICByZXR1cm4gewogICAgICAgIHRuYW1lOiAnJywKICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy50YXNrID09PSB1bmRlZmluZWQgPyAnJzp0aGlzLnRhc2suZGVzY3JpcHRpb24sCiAgICAgICAgZW5kRGF0ZTogJycsCiAgICAgICAgZW5kX3RpbWU6ICcnLAogICAgICAgIGFubmV4OiBbXSwKICAgICAgICBhbm5leF9tYXA6IFtdLAogICAgICAgIG91dGRhdGU6IGZhbHNlLAogICAgICAgIG1heF9wb2ludDogJycsCiAgICAgICAgY2hlY2tfZHVtcDogZmFsc2UsCiAgICAgICAgYWxhcm1fbGluZTogJycsCiAgICAgICAgYXV0b19hbGFybTogZmFsc2UsCiAgICAgIH0KICAgIH0sCiAgICBtb3VudGVkKCkgewogICAgICBpZiAodGhpcy5lZGl0KSB7CiAgICAgICAgdGhpcy5wdXRVcCgpCiAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgIGNhbmNlbCgpIHsKICAgICAgICB0aGlzLiRlbWl0KCdkZWxpdmVyJywwKQogICAgICB9LAogICAgICBzdWJtaXQoKSB7CiAgICAgICAgY29uc3QgZGF0YSA9IHsKICAgICAgICAgIHRubzogdGhpcy50YXNrID09PSB1bmRlZmluZWQgPyAnJyA6IHRoaXMudGFzay50bm8sCiAgICAgICAgICB0bmFtZTogdGhpcy50bmFtZSwKICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLmRlc2NyaXB0aW9uLAogICAgICAgICAgYW5uZXg6IHRoaXMuZm9ybV9hbm5leCgpLAogICAgICAgICAgYXZnU2NvcmU6IHRoaXMudGFzayA9PT0gdW5kZWZpbmVkID8gMDp0aGlzLnRhc2suYXZnU2NvcmUsCiAgICAgICAgICBwYXNzUmF0ZTogdGhpcy50YXNrID09PSB1bmRlZmluZWQgPyAwOnRoaXMudGFzay5wYXNzUmF0ZSwKICAgICAgICAgIGhpZ2hlc3RTY29yZTogdGhpcy50YXNrID09PSB1bmRlZmluZWQgPyAwOnRoaXMudGFzay5oaWdoZXN0U2NvcmUsCiAgICAgICAgICBsb3dlc3RTY29yZTogdGhpcy50YXNrID09PSB1bmRlZmluZWQgPyAwOnRoaXMudGFzay5sb3dlc3RTY29yZSwKICAgICAgICAgIGNyZWF0ZURhdGU6IG5ldyBEYXRlKCkuZm9ybWF0KCd5eXl5LU1NLWRkVGhoOm1tOnNzKzA4MDAnKSwKICAgICAgICAgIGVuZERhdGU6ICh0aGlzLmVuZERhdGUgKyAnVCcgKyB0aGlzLmVuZF90aW1lICsgJzowMCswODAwJyksCiAgICAgICAgICBzdWJtaXROdW06IHRoaXMudGFzayA9PT0gdW5kZWZpbmVkID8gMDp0aGlzLnRhc2suc3VibWl0TnVtLAogICAgICAgICAganVkZ2VOdW06IHRoaXMudGFzayA9PT0gdW5kZWZpbmVkID8gMDp0aGlzLnRhc2suanVkZ2VOdW0sCiAgICAgICAgICBjbm86IHRoaXMudGFzayA9PT0gdW5kZWZpbmVkID8gdGhpcy5jbm86dGhpcy50YXNrLmNubywKICAgICAgICB9CgogICAgICAgIGF4aW9zLnBvc3QodGhpcy5lZGl0ID8gJy9hcGkvdXBkYXRlVGFzayc6Jy9hcGkvaW5zZXJ0VGFzaycsIGRhdGEpLnRoZW4ocmVzID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0tJykKICAgICAgICAgIHRoaXMuYW5uZXhfbWFwID0gW10KICAgICAgICAgIHRoaXMuJGVtaXQoJ3NlbmQnKQogICAgICAgICAgdGhpcy4kZW1pdCgnZGVsaXZlcicpCiAgICAgICAgfSkKCiAgICAgIH0sCiAgICAgIHB1dFVwKCkgewogICAgICAgIHRoaXMudG5hbWUgPSB0aGlzLnRhc2sudG5hbWUKICAgICAgICB0aGlzLmVuZERhdGUgPSBuZXcgRGF0ZSh0aGlzLnRhc2suZW5kRGF0ZSkuZm9ybWF0KCd5eXl5LU1NLWRkJykKICAgICAgICB0aGlzLmVuZF90aW1lID0gbmV3IERhdGUodGhpcy50YXNrLmVuZERhdGUpLmZvcm1hdCgnaGg6bW0nKQogICAgICAgIHRoaXMuYW5uZXggPSB0aGlzLmFubmV4X2Zvcm1hdCh0aGlzLnRhc2suYW5uZXgpCiAgICAgIH0sCiAgICAgIHVwRGVzY3JpcHRpb24oZGVzY3JpcHRpb24pIHsKICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24KICAgICAgICBjb25zb2xlLmxvZyhkZXNjcmlwdGlvbikKICAgICAgfSwKICAgICAgYW5uZXhfZm9ybWF0KGFubmV4KSB7CiAgICAgICAgaWYgKGFubmV4ID09PSBudWxsKSB7CiAgICAgICAgICByZXR1cm4gW10KICAgICAgICB9CiAgICAgICAgdmFyIHRlbXAgPSBhbm5leC5zcGxpdCgnPycpCiAgICAgICAgdmFyIGFubmV4X3RlbXAgPSBbXQogICAgICAgIHRlbXAuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgIGFubmV4X3RlbXAucHVzaCh7CiAgICAgICAgICAgIG9yaU5hbWU6IGl0ZW0sCiAgICAgICAgICAgIG5hbWU6IGl0ZW0uc3Vic3RyaW5nKDEwKSwKICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgICAgICByZXR1cm4gYW5uZXhfdGVtcAogICAgICB9LAogICAgICBhbm5leFVwbG9hZFN1Y2Nlc3MocmVzKSB7CiAgICAgICAgdGhpcy5hbm5leC5wdXNoKHsKICAgICAgICAgIG9yaU5hbWU6IHJlcywKICAgICAgICAgIG5hbWU6IHJlcy5zdWJzdHJpbmcoMTApCiAgICAgICAgfSkKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIumZhOS7tuS4iuS8oOaIkOWKnyIpCiAgICAgIH0sCiAgICAgIGFubmV4VXBsb2FkRXJyb3IocmVzKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi6ZmE5Lu25LiK5Lyg5aSx6LSlIikKICAgICAgfSwKICAgICAgYW5uZXhCZWZvcmVEZWxldGUoZmlsZSkgewogICAgICAgIHRoaXMuYW5uZXguZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICAgIGlmIChpdGVtLm5hbWUgPT09IGZpbGUubmFtZSkgewogICAgICAgICAgICB0aGlzLmFubmV4LnNsaWNlKGluZGV4LCAxKQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgIH0sCiAgICAgIGZvcm1fYW5uZXgoKSB7CiAgICAgICAgdmFyIGFubmV4X3RlbXAgPSAnJwogICAgICAgIGlmICh0aGlzLmFubmV4ICE9PSBbXSkgewogICAgICAgICAgdGhpcy5hbm5leC5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgICAgICBhbm5leF90ZW1wID0gYW5uZXhfdGVtcC5jb25jYXQoaXRlbS5vcmlOYW1lICsgJz8nKQogICAgICAgICAgfSkKICAgICAgICAgIGFubmV4X3RlbXAgPSBhbm5leF90ZW1wLnN1YnN0cmluZygwLCBhbm5leF90ZW1wLmxlbmd0aCAtIDEpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBudWxsCiAgICAgICAgfQogICAgICAgIHJldHVybiBhbm5leF90ZW1wCiAgICAgIH0KICAgIH0KICAgIAogIH0K"},{"version":3,"sources":["PersonalDeliver.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"PersonalDeliver.vue","sourceRoot":"src/components/content","sourcesContent":["<template>\n  <div class=\"personal-deliver\">\n    <form id=\"personal_form\">\n      <el-input v-model=\"tname\" placeholder=\"作业名称\"></el-input>\n      <Editor class=\"editor\" :description=\"description\" @description=\"upDescription\"/>\n      <el-upload\n        class=\"annex-upload\"\n        multiple\n        action=\"/api/annex/upload\"\n        :file-list=\"annex\"\n        :on-success=\"annexUploadSuccess\"\n        :on-error=\"annexUploadError\"\n        :before-remove=\"annexBeforeDelete\">\n        <el-button type=\"primary\" class=\"annex-button\"><i class=\"el-icon-paperclip el-icon--left\"/>上传附件</el-button>\n      </el-upload>\n      <div class=\"form-line\">\n        <span class=\"form-span\">截止日期：</span>\n        <el-date-picker\n          v-model=\"endDate\"\n          type=\"date\"\n          placeholder=\"选择日期\"\n          value-format=\"yyyy-MM-dd\"\n          :clearable=\"false\">\n        </el-date-picker>\n        <el-time-select v-model=\"end_time\" :picker-options=\"{\n              start: '00:00',\n              step: '00:15',\n              end: '23:45'\n            }\" placeholder=\"选择时间\" v-if=\"endDate !== ''\" style=\"margin-left: 20px;\">\n        </el-time-select>\n        <el-switch\n          v-model=\"outdate\"\n          v-if=\"endDate !== ''\"\n          active-text=\"若超时，禁止提交\"\n          style=\"margin-left: 50px\">\n        </el-switch>\n      </div>\n      <div class=\"form-line\">\n        <span class=\"form-span\">满分值：</span>\n        <el-input v-model=\"max_point\" style=\"width: 60px\"></el-input>\n      </div>\n      <div class=\"form-line\">\n        <span class=\"form-span\" style=\"line-height: 40px;height: 40px\">是否查重：</span>\n        <el-switch\n          v-model=\"check_dump\">\n        </el-switch>\n        <span v-if=\"check_dump === true\">\n          <span style=\"margin-left: 20px;color: #a0a0a0\">查重禁戒值：</span>\n          <el-input v-model=\"alarm_line\" style=\"width: 60px;margin-left: 10px;\"></el-input>\n          <span style=\"text-align: right;width: 20px;display: inline-block\">%</span>\n        </span>\n        <div style=\"margin-top: 15px;\" v-if=\"check_dump === true\">\n          <span class=\"form-span\"></span>\n          <el-checkbox v-model=\"auto_alarm\"></el-checkbox>\n          <span v-if=\"check_dump === true\">\n            <span style=\"margin-left: 20px;color: #a0a0a0\">查重率高于</span>\n            <el-input v-model=\"alarm_line\" style=\"width: 60px;margin-left: 10px;\"></el-input>\n            <span style=\"text-align: right;width: 80px;display: inline-block\">%自动打回</span>\n          </span>\n        </div>\n      </div>\n      <div class=\"form-line\">\n        <el-button type=\"primary\" style=\"float: left\"><i class=\"el-icon-download el-icon--left\"/>导入作业</el-button>\n        <span style=\"float: right;display: flex;justify-content: space-between\">\n          <el-button type=\"primary\" @click=\"cancel\" style=\"float: left\">取消</el-button>\n          <el-button type=\"primary\" @click=\"submit\" style=\"float: left\">{{ edit ? \"保存\":\"发布个人作业\" }}</el-button>\n        </span>\n      </div>\n    </form>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\";\n  import Editor from \"@/components/content/Editor\";\n\n    export default {\n      name: \"PersonalDeliver\",\n      components: {Editor},\n      props: {\n        edit: {\n          type:Boolean,\n          default:false\n        },\n        task: {\n          type:Object\n        },\n        cno: {\n          type: String\n        }\n      },\n      data() {\n        return {\n          tname: '',\n          description: this.task === undefined ? '':this.task.description,\n          endDate: '',\n          end_time: '',\n          annex: [],\n          annex_map: [],\n          outdate: false,\n          max_point: '',\n          check_dump: false,\n          alarm_line: '',\n          auto_alarm: false,\n        }\n      },\n      mounted() {\n        if (this.edit) {\n          this.putUp()\n        }\n      },\n      methods: {\n        cancel() {\n          this.$emit('deliver',0)\n        },\n        submit() {\n          const data = {\n            tno: this.task === undefined ? '' : this.task.tno,\n            tname: this.tname,\n            description: this.description,\n            annex: this.form_annex(),\n            avgScore: this.task === undefined ? 0:this.task.avgScore,\n            passRate: this.task === undefined ? 0:this.task.passRate,\n            highestScore: this.task === undefined ? 0:this.task.highestScore,\n            lowestScore: this.task === undefined ? 0:this.task.lowestScore,\n            createDate: new Date().format('yyyy-MM-ddThh:mm:ss+0800'),\n            endDate: (this.endDate + 'T' + this.end_time + ':00+0800'),\n            submitNum: this.task === undefined ? 0:this.task.submitNum,\n            judgeNum: this.task === undefined ? 0:this.task.judgeNum,\n            cno: this.task === undefined ? this.cno:this.task.cno,\n          }\n\n          axios.post(this.edit ? '/api/updateTask':'/api/insertTask', data).then(res => {\n            console.log('-------------')\n            this.annex_map = []\n            this.$emit('send')\n            this.$emit('deliver')\n          })\n\n        },\n        putUp() {\n          this.tname = this.task.tname\n          this.endDate = new Date(this.task.endDate).format('yyyy-MM-dd')\n          this.end_time = new Date(this.task.endDate).format('hh:mm')\n          this.annex = this.annex_format(this.task.annex)\n        },\n        upDescription(description) {\n          this.description = description\n          console.log(description)\n        },\n        annex_format(annex) {\n          if (annex === null) {\n            return []\n          }\n          var temp = annex.split('?')\n          var annex_temp = []\n          temp.forEach(item => {\n            annex_temp.push({\n              oriName: item,\n              name: item.substring(10),\n            })\n          })\n          return annex_temp\n        },\n        annexUploadSuccess(res) {\n          this.annex.push({\n            oriName: res,\n            name: res.substring(10)\n          })\n          this.$message.success(\"附件上传成功\")\n        },\n        annexUploadError(res) {\n          this.$message.error(\"附件上传失败\")\n        },\n        annexBeforeDelete(file) {\n          this.annex.forEach((item, index) => {\n            if (item.name === file.name) {\n              this.annex.slice(index, 1)\n            }\n          })\n        },\n        form_annex() {\n          var annex_temp = ''\n          if (this.annex !== []) {\n            this.annex.forEach(item => {\n              annex_temp = annex_temp.concat(item.oriName + '?')\n            })\n            annex_temp = annex_temp.substring(0, annex_temp.length - 1)\n          } else {\n            return null\n          }\n          return annex_temp\n        }\n      }\n      \n    }\n</script>\n\n<style scoped>\n  .personal-deliver {\n    border: 1px solid #E2E6ED;\n    margin-top: 20px;\n    border-radius: 8px;\n    background: #fff;\n    padding: 20px 20px 60px;\n    text-align: left;\n  }\n  .annex-button {\n    float: left;\n  }\n  .editor, .form-line, .annex-upload {\n    margin-top: 20px;\n  }\n  .editor {\n    position: relative;\n    z-index: 40;\n  }\n  .form-span {\n    display: inline-block;\n    width: 70px;\n    text-align: right;\n    margin-right: 15px;\n  }\n</style>\n"]}]}