{"remainingRequest":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\src\\views\\Profile\\Profile.vue?vue&type=style&index=0&id=28473e59&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\src\\views\\Profile\\Profile.vue","mtime":1592552352000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_css-loader@3.6.0@css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_postcss-loader@3.0.0@postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\ktp2\\ktp2\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5vdXRlciB7CiAgaGVpZ2h0OiAxMDAlOwogIHBvc2l0aW9uOiByZWxhdGl2ZTsKfQoKLyog5LiK6YOo5YiGICovCi5sYXllci10b3AgewogIGhlaWdodDogMjAwcHg7CiAgbWFyZ2luLXRvcDogNjVweDsKICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI0M4QzhDODsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgbWFyZ2luLWJvdHRvbTogNDBweDsKICBvdmVyZmxvdzogaGlkZGVuOwp9Ci5sYXllci10b3A+ZGl2OmZpcnN0LWNoaWxkIHsKICBtYXJnaW46IDQ1cHggYXV0byAwOwogIHdpZHRoOiA3M3B4Owp9Ci5sYXllci10b3A+ZGl2OmZpcnN0LWNoaWxkOmhvdmVyPi5hdmF0YXItdXBsb2FkZXIgewogIG9wYWNpdHk6IDE7Cn0KLmxheWVyLXRvcD5kaXY6Zmlyc3QtY2hpbGQ+aW1nIHsKICBoZWlnaHQ6IDczcHg7CiAgd2lkdGg6IDczcHg7CiAgbWFyZ2luOiAwIGF1dG87CiAgYm9yZGVyLXJhZGl1czogNTAlOwp9Ci5sYXllci10b3A+aDEgewogIHBhZGRpbmc6IDQzcHggMCAxMHB4OwogIGZvbnQtc2l6ZTogMjhweDsKICBmb250LXdlaWdodDogNzAwOwogIG1hcmdpbi10b3A6IC0zMHB4OwogIGxpbmUtaGVpZ2h0OiAzNHB4OwogIGhlaWdodDogMzRweDsKfQoKLyog5LiL6YOo5YiGICovCi5sYXllci1ib3R0b20gewogIGJvcmRlcjogMXB4IHNvbGlkICNjOGM4Yzg7CiAgbWFyZ2luLXRvcDogNDBweDsKICBtYXJnaW4tYm90dG9tOiA2MHB4OwogIHBhZGRpbmctYm90dG9tOiA2MHB4OwogIGJhY2tncm91bmQ6ICNmZmY7CiAgZm9udC1zaXplOiAxNHB4Owp9Ci5sYXllci1ib3R0b20+ZGl2IHsKICBwYWRkaW5nOiAyMHB4IDEyMHB4IDA7Cn0KLmxheWVyLWJvdHRvbT5kaXY+ZGl2IHsKICBtYXJnaW4tdG9wOiAyMHB4Owp9Ci5sYXllci1ib3R0b20+ZGl2PmRpdj5oMyB7CiAgZm9udC1zaXplOiAxNHB4OwogIGNvbG9yOiAjMzMzOwogIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjRENEQ0RDOwogIHBhZGRpbmctYm90dG9tOiAyMHB4OwogIGxpbmUtaGVpZ2h0OiAxOwp9Ci5sYXllci1ib3R0b20+ZGl2PmRpdj51bCB7CiAgcGFkZGluZy10b3A6IDEwcHg7Cn0KLmxheWVyLWJvdHRvbT5kaXY+ZGl2PnVsPmxpIHsKICBoZWlnaHQ6IDMycHg7CiAgbWFyZ2luLXRvcDogMTBweDsKfQoubGF5ZXItYm90dG9tPmRpdj5kaXY+dWw+bGk+cCB7CiAgZmxvYXQ6IGxlZnQ7CiAgbWluLXdpZHRoOiA3NXB4OwogIGxpbmUtaGVpZ2h0OiAzMnB4OwogIGNvbG9yOiAjOTY5Njk2Owp9CmxpIHsKICBsaXN0LXN0eWxlOiBub25lOwp9CgoubGF5ZXItYm90dG9tPmRpdj5kaXY+dWw+bGk+ZGl2Om50aC1jaGlsZCgyKT5zcGFuIHsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgY29sb3I6ICM1OTU5NTk7CiAgbGluZS1oZWlnaHQ6IDMycHg7CiAgaGVpZ2h0OiAzMnB4Owp9CgoubGF5ZXItYm90dG9tPmRpdj5kaXY+dWw+bGk+ZGl2Om50aC1jaGlsZCgyKT5pbnB1dCB7CiAgd2lkdGg6IDE3MnB4OwogIGhlaWdodDogMzBweDsKICBsaW5lLWhlaWdodDogMzBweFw5OwogIGJvcmRlcjogMXB4IHNvbGlkICNjOGM4Yzg7CiAgY29sb3I6ICM1OTU5NTk7CiAgcGFkZGluZzogMCAxNHB4OwogIGJvcmRlci1yYWRpdXM6IDNweDsKICBmb250LXNpemU6IDE0cHg7CiAgb3V0bGluZTogbm9uZTsKfQoubGF5ZXItYm90dG9tPmRpdj5kaXY+dWw+bGk+ZGl2Om50aC1jaGlsZCgyKT5pbnB1dDpmb2N1cyB7CiAgYm9yZGVyOiAxcHggc29saWQgIzRkOTBmZTsKfQoubGF5ZXItYm90dG9tPmRpdj5kaXY+dWw+bGk6bnRoLWNoaWxkKDIpPmRpdjpudGgtY2hpbGQoMik+YiB7CiAgZGlzcGxheTogbm9uZTsKICBsaW5lLWhlaWdodDogMzJweDsKICBjb2xvcjogcmVkOwogIGZvbnQtc2l6ZTogMTJweDsKICBtYXJnaW4tbGVmdDogMjBweDsKICBmb250LXdlaWdodDogNDAwOwp9CgoubGF5ZXItYm90dG9tPmRpdj5kaXY+dWw+bGk6Zmlyc3QtY2hpbGQ+ZGl2Omxhc3QtY2hpbGQgewogIGZsb2F0OiByaWdodDsKICBtaW4td2lkdGg6IDU2cHg7CiAgaGVpZ2h0OiAyMnB4OwogIHRleHQtYWxpZ246IGNlbnRlcjsKICBsaW5lLWhlaWdodDogMjJweDsKICBmb250LXNpemU6IDEycHg7CiAgYm9yZGVyLXJhZGl1czogM3B4OwogIG1hcmdpbi10b3A6IDNweDsKICBwYWRkaW5nLWxlZnQ6IDVweDsKICBwYWRkaW5nLXJpZ2h0OiA1cHg7CiAgY3Vyc29yOiBwb2ludGVyOwogIHVzZXItc2VsZWN0OiBub25lOwogIGNvbG9yOiAjODE4MTgxOwogIGJvcmRlcjogMXB4IHNvbGlkICNjOGM4Yzg7CiAgdHJhbnNpdGlvbjogLjNzOwp9CgoubGF5ZXItYm90dG9tPmRpdj5kaXY6bnRoLWNoaWxkKDEpPnVsPmxpOmZpcnN0LWNoaWxkPmRpdjpsYXN0LWNoaWxkOmhvdmVyLAoubGF5ZXItYm90dG9tPmRpdj5kaXY6bnRoLWNoaWxkKDIpPnVsPmxpOmZpcnN0LWNoaWxkPmRpdjpsYXN0LWNoaWxkOmhvdmVyLAoubGF5ZXItYm90dG9tPmRpdj5kaXY6bnRoLWNoaWxkKDMpPnVsPmxpOmZpcnN0LWNoaWxkPmRpdjpsYXN0LWNoaWxkOmhvdmVyIHsKICBjb2xvcjogIzJkMmQyZDsKICBiYWNrZ3JvdW5kOiAjZTZlNmU2Owp9CgouZWRpdC1ib3ggewogIGZsb2F0OiBsZWZ0OwogIHBvc2l0aW9uOiByZWxhdGl2ZTsKfQouc2F2ZS1idG4gewogIGRpc3BsYXk6IGJsb2NrOwogIG1hcmdpbi1sZWZ0OiA3NXB4OwogIHdpZHRoOiA1NnB4OwogIGhlaWdodDogMjZweDsKICBib3JkZXItcmFkaXVzOiAzcHg7CiAgYmFja2dyb3VuZDogIzRkOTBmZTsKICBjb2xvcjogI0ZGRjsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgbGluZS1oZWlnaHQ6IDI2cHg7CiAgbWFyZ2luLXRvcDogMTBweDsKICBjdXJzb3I6IHBvaW50ZXI7CiAgdXNlci1zZWxlY3Q6IG5vbmU7Cn0KCi8qIOS4iuS8oOWktOWDjyAqLwouYXZhdGFyLXVwbG9hZGVyIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiA0NXB4OwogIGNvbG9yOiAjRkZGOwogIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsLjMpOwogIHRyYW5zaXRpb246IC41cyBlYXNlOwogIGZvbnQtc2l6ZTogMTRweDsKICBib3JkZXItcmFkaXVzOiA1MCU7CiAgb3BhY2l0eTogMDsKfQouYXZhdGFyLXVwbG9hZGVyIC5lbC11cGxvYWQgewogIGJvcmRlcjogMXB4IGRhc2hlZCAjZDlkOWQ5OwogIGJvcmRlci1yYWRpdXM6IDZweDsKICBjdXJzb3I6IHBvaW50ZXI7CiAgb3ZlcmZsb3c6IGhpZGRlbjsKfQouZWwtdXBsb2FkPmRpdiB7CiAgaGVpZ2h0OiA3M3B4OwogIHdpZHRoOiA3M3B4OwogIGJvcmRlci1yYWRpdXM6IDUwJTsKICBsaW5lLWhlaWdodDogNzNweDsKICB0ZXh0LWFsaWduOiBjZW50ZXI7Cn0KLmF2YXRhci11cGxvYWRlci1pY29uIHsKICBmb250LXNpemU6IDI4cHg7CiAgY29sb3I6ICM4YzkzOWQ7CiAgd2lkdGg6IDczcHg7CiAgaGVpZ2h0OiA3M3B4OwogIGJvcmRlci1yYWRpdXM6IDUwJTsKICBsaW5lLWhlaWdodDogNzNweDsKICB0ZXh0LWFsaWduOiBjZW50ZXI7Cn0K"},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8UA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/views/Profile","sourcesContent":["<template>\r\n  <div class=\"outer\">\r\n    <home-nav />\r\n    <!-- 上部分 -->\r\n    <div class=\"layer-top\">\r\n      <div>\r\n        <img :src=\"avatar\" :alt=\"user.name\" />\r\n        <el-upload\r\n          class=\"avatar-uploader\"\r\n          :data=\"{uid: $store.state.uid}\"\r\n          action=\"/api/file/upload\"\r\n          :on-success=\"uploadSuccess\"\r\n          :on-error=\"uploadError\"\r\n          :show-file-list=\"false\"\r\n          :before-upload=\"beforeAvatarUpload\">\r\n          <div>更改头像</div>\r\n        </el-upload>\r\n      </div>\r\n      <h1>{{user.name}}</h1>\r\n    </div>\r\n    <div class=\"layer-bottom\">\r\n      <div>\r\n        <div>\r\n          <h3>基本资料</h3>\r\n          <ul>\r\n            <li>\r\n              <p>姓名：</p>\r\n              <div class=\"edit-box\">\r\n                <span v-if=\"!editBasic\">{{user.name}}</span>\r\n                <input v-else type=\"text\" name=\"name\" v-model=\"username\" placeholder=\"请输入姓名\" />\r\n              </div>\r\n              <div v-if=\"!editBasic\" @click=\"changeEdit(1)\">编辑资料</div>\r\n              <div v-else @click=\"changeEdit(1)\">放弃编辑</div>\r\n            </li>\r\n            <li>\r\n              <p>学校：</p>\r\n              <div class=\"edit-box\">\r\n                <span v-if=\"!editBasic\">{{showSchool}}</span>\r\n                <input v-else type=\"text\" name=\"school\" v-model=\"school\" placeholder=\"请输入学校\" />\r\n              </div>\r\n            </li>\r\n          </ul>\r\n          <div v-if=\"editBasic\" class=\"save-btn\" @click=\"save(1)\">保存</div>\r\n        </div>\r\n        <div>\r\n          <h3>身份角色</h3>\r\n          <ul>\r\n            <li>\r\n              <p>角色：</p>\r\n              <div class=\"edit-box\">\r\n                <span v-if=\"!editPermission\">{{showPermission}}</span>\r\n                <div v-else>\r\n                  <el-radio v-model=\"permission\" :label=\"1\">学生</el-radio>\r\n                  <el-radio v-model=\"permission\" :label=\"2\">教师</el-radio>\r\n                </div>\r\n              </div>\r\n              <div v-if=\"!editPermission\" @click=\"changeEdit(2)\">变更身份</div>\r\n              <div v-else @click=\"changeEdit(2)\">放弃变更</div>\r\n            </li>\r\n          </ul>\r\n          <div v-if=\"editPermission\" class=\"save-btn\" @click=\"save(2)\">保存</div>\r\n        </div>\r\n        <div>\r\n          <h3>账号设置</h3>\r\n          <ul>\r\n            <li>\r\n              <p v-if=\"!editUser\">账号：</p>\r\n              <p v-else>新密码：</p>\r\n              <div class=\"edit-box\">\r\n                <span v-if=\"!editUser\">{{user.account}}</span>\r\n                <input v-else type=\"password\" name=\"password\" v-model=\"pwd\" placeholder=\"请输入新密码\" />\r\n              </div>\r\n              <div v-if=\"!editUser\" @click=\"changeEdit(3)\">修改</div>\r\n              <div v-else @click=\"changeEdit(3)\">放弃修改</div>\r\n            </li>\r\n            <li>\r\n              <p v-if=\"!editUser\">密码：</p>\r\n              <p v-else>确认密码：</p>\r\n              <div class=\"edit-box\">\r\n                <span v-if=\"!editUser\">******</span>\r\n                <input v-else type=\"password\" name=\"passwordAgain\" v-model=\"pwdAgain\" placeholder=\"请再次输入密码\" @focus=\"pwdChange(2)\" @blur=\"pwdChange(1)\" />\r\n                <b>两次密码不一致</b>\r\n              </div>\r\n            </li>\r\n          </ul>\r\n          <div v-if=\"editUser\" class=\"save-btn\" @click=\"save(3)\">保存</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport HomeNav from 'components/content/HomeNav'\r\nimport {request} from 'network/request'\r\nimport axios from 'axios'\r\nimport {USER_AVATAR} from \"../../store/mutation-type\"\r\n\r\nexport default {\r\n  name: 'Profile',\r\n  components: {\r\n    HomeNav\r\n  },\r\n  data() {\r\n    return {\r\n      avatar: '',\r\n      user: {},\r\n      schools: [],\r\n      school: '',\r\n      username: '',\r\n      permission: '',\r\n      pwd: '',\r\n      pwdAgain: '',\r\n      editBasic: false,\r\n      editPermission: false,\r\n      editUser: false\r\n    }\r\n  },\r\n  computed: {\r\n    showSchool() {\r\n      return this.user.school === undefined ? '' : this.user.school.sclName\r\n    },\r\n    showPermission() {\r\n      return this.user.permission === undefined ? '' : this.user.permission.pname\r\n    }\r\n  },\r\n  mounted() {\r\n    this.avatar = require('../../assets/avatar/' + this.$store.state.avatar)\r\n    // 获取个人信息\r\n    const profileInfo = request({\r\n      url: '/api/findEntityByUid',\r\n      method: 'get',\r\n      params: {\r\n        uid: this.$store.state.uid\r\n      }\r\n    })\r\n    // 获取学校信息\r\n    const sclInfo = request({\r\n      url: '/api/selectSchool',\r\n      method: 'get'\r\n    })\r\n\r\n    // 当两个请求都完成是再处理\r\n    axios.all([profileInfo, sclInfo])\r\n    .then(axios.spread((res1, res2) => {\r\n      this.user = res1.data\r\n      this.schools = res2.data\r\n      this.username = this.user.name\r\n      this.school = this.user.school.sclName\r\n      this.permission = this.user.permission.pid\r\n    })).catch(err => {\r\n      console.log(err)\r\n    })\r\n  },\r\n  methods: {\r\n    changeEdit(index) {\r\n      let flag = ''\r\n\r\n      if (index === 1) {\r\n        this.editBasic = !this.editBasic\r\n        flag = this.editBasic\r\n      } else if (index === 2) {\r\n        this.editPermission = !this.editPermission\r\n        flag = this.editPermission\r\n      } else if (index === 3) {\r\n        this.editUser = !this.editUser\r\n        flag = this.editUser\r\n      }\r\n      \r\n      // 设置部分css样式\r\n      // 基础资料部分\r\n      if (!flag) {\r\n        document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).style.color = \"#818181\"\r\n        document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).style.border = \"1px solid #c8c8c8\"\r\n        document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).onmouseover = () => {\r\n          document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).style.color = \"#2d2d2d\"\r\n          document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).style.background = \"#e6e6e6\"\r\n        }\r\n        document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).onmouseout = () => {\r\n          document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).style.color = \"#818181\"\r\n          document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).style.background = \"none\"\r\n        }\r\n        \r\n        if (index === 3) {\r\n          document.querySelector('.layer-bottom>div>div>ul>li:nth-child(2)>div:nth-child(2)>b').style.display = \"none\"\r\n        }\r\n\r\n        // 未修改则将只还原为原本的值\r\n        this.permission = this.user.permission.pid\r\n        this.school = this.user.school.sclName\r\n        this.username = this.user.name\r\n      } else {\r\n        document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).style.color = \"#4d90fe\"\r\n        document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).style.border = \"1px solid #4d90fe\"\r\n        document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).onmouseover = () => {\r\n          document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).style.color = \"#fff\"\r\n          document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).style.background = \"#4d90fe\"\r\n        }\r\n        document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).onmouseout = () => {\r\n          document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).style.color = \"#4d90fe\"\r\n          document.querySelector(`.layer-bottom>div>div:nth-child(${index})>ul>li:first-child>div:last-child`).style.background = \"none\"\r\n        }\r\n      }\r\n    },\r\n    pwdChange(flag) {\r\n      // 1是blur，2是focus\r\n      if (flag === 1) {\r\n        if (this.pwd !== this.pwdAgain) {\r\n          document.querySelector('.layer-bottom>div>div>ul>li:nth-child(2)>div:nth-child(2)>b').style.display = \"inline-block\"\r\n        }\r\n      } else {\r\n        document.querySelector('.layer-bottom>div>div>ul>li:nth-child(2)>div:nth-child(2)>b').style.display = \"none\"\r\n      }\r\n    },\r\n    // 头像上传\r\n    beforeAvatarUpload(file) {\r\n      const isJPG = file.type === 'image/jpeg';\r\n      const isLt2M = file.size / 1024 / 1024 < 2;\r\n\r\n      if (!isJPG) {\r\n        this.$message.error('上传头像图片只能是 JPG 格式!');\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error('上传头像图片大小不能超过 2MB!');\r\n      }\r\n      return isJPG && isLt2M;\r\n    },\r\n    uploadSuccess(res) {\r\n      // 头像上传成功，重新渲染用户的头像\r\n      if (res !== false) {\r\n        this.$message.success('上传成功')\r\n        this.$store.commit(USER_AVATAR, res)\r\n        this.avatar = res\r\n      } else {\r\n        this.$message.error('上传失败')\r\n      }\r\n      \r\n    },\r\n    uploadError(res) {\r\n      this.$message.error('上传失败')\r\n    },\r\n    save(status) {\r\n      if (status === 1) {\r\n        // 修改基本信息->姓名、学校\r\n        const nowSchool = this.schools.filter(e => e.sclName === this.school)\r\n        if (nowSchool.length !== 0) {\r\n          this.user.school = nowSchool[0]\r\n          this.user.name = this.username\r\n          this.user.pid = this.user.permission.pid\r\n          this.user.sclID = this.user.school.sclID\r\n\r\n          // 修改\r\n          request({\r\n            url: '/api/updateUserInfo',\r\n            method: 'put',\r\n            params: {\r\n              name: this.user.name,\r\n              sclID: this.user.school.sclID,\r\n              userId: this.user.userId\r\n            }\r\n          }).then(res => {\r\n            this.$message.success('基本信息修改成功')\r\n          }).catch(err => {\r\n            this.$message.success('基本信息修改失败')\r\n          })\r\n        } else {\r\n          this.school = this.user.school.sclName\r\n          this.$message.error('基本信息修改失败')\r\n        }\r\n        \r\n        this.changeEdit(1)\r\n      } else if (status === 2) {\r\n        if (this.user.permission.pid === 2) {\r\n          this.$message.warning('教师角色已是会员，无法修改')\r\n        } else {\r\n          // 修改角色信息->角色\r\n          this.user.pid = this.permission\r\n          this.user.sclID = this.user.school.sclID\r\n          \r\n          if (this.permission === 1) {\r\n            this.user.permission = {pid: this.permission, pname: '学生'}\r\n          } else {\r\n            this.user.permission = {pid: this.permission, pname: '教师'}\r\n          }\r\n          \r\n          // 修改\r\n          request({\r\n            url: '/api/updateUserInfo',\r\n            method: 'put',\r\n            params: {\r\n              pid: this.user.pid,\r\n              userId: this.user.userId\r\n            }\r\n          }).then(res => {\r\n            this.$message.success('角色信息修改成功')\r\n          }).catch(err => {\r\n            this.$message.success('角色信息修改失败')\r\n          })\r\n        }\r\n        \r\n\r\n        this.changeEdit(2)\r\n      } else {\r\n        // 修改密码\r\n        if (this.pwd !== this.pwdAgain) {\r\n          this.$message.error('请检验输入是否合法')\r\n        } else {\r\n          this.user.pid = this.permission\r\n          this.user.sclID = this.user.school.sclID\r\n          this.user.password = this.pwd\r\n\r\n          // 修改\r\n          request({\r\n            url: '/api/updateUserInfo',\r\n            method: 'put',\r\n            params: {\r\n              password: this.user.password,\r\n              userId: this.user.userId\r\n            }\r\n          }).then(res => {\r\n            this.$message.success('密码修改成功')\r\n          }).catch(err => {\r\n            this.$message.success('密码修改失败')\r\n          })\r\n        }\r\n\r\n        this.changeEdit(3)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n  .outer {\r\n    height: 100%;\r\n    position: relative;\r\n  }\r\n  \r\n  /* 上部分 */\r\n  .layer-top {\r\n    height: 200px;\r\n    margin-top: 65px;\r\n    border-bottom: 1px solid #C8C8C8;\r\n    text-align: center;\r\n    margin-bottom: 40px;\r\n    overflow: hidden;\r\n  }\r\n  .layer-top>div:first-child {\r\n    margin: 45px auto 0;\r\n    width: 73px;\r\n  }\r\n  .layer-top>div:first-child:hover>.avatar-uploader {\r\n    opacity: 1;\r\n  }\r\n  .layer-top>div:first-child>img {\r\n    height: 73px;\r\n    width: 73px;\r\n    margin: 0 auto;\r\n    border-radius: 50%;\r\n  }\r\n  .layer-top>h1 {\r\n    padding: 43px 0 10px;\r\n    font-size: 28px;\r\n    font-weight: 700;\r\n    margin-top: -30px;\r\n    line-height: 34px;\r\n    height: 34px;\r\n  }\r\n\r\n  /* 下部分 */\r\n  .layer-bottom {\r\n    border: 1px solid #c8c8c8;\r\n    margin-top: 40px;\r\n    margin-bottom: 60px;\r\n    padding-bottom: 60px;\r\n    background: #fff;\r\n    font-size: 14px;\r\n  }\r\n  .layer-bottom>div {\r\n    padding: 20px 120px 0;\r\n  }\r\n  .layer-bottom>div>div {\r\n    margin-top: 20px;\r\n  }\r\n  .layer-bottom>div>div>h3 {\r\n    font-size: 14px;\r\n    color: #333;\r\n    border-bottom: 1px solid #DCDCDC;\r\n    padding-bottom: 20px;\r\n    line-height: 1;\r\n  }\r\n  .layer-bottom>div>div>ul {\r\n    padding-top: 10px;\r\n  }\r\n  .layer-bottom>div>div>ul>li {\r\n    height: 32px;\r\n    margin-top: 10px;\r\n  }\r\n  .layer-bottom>div>div>ul>li>p {\r\n    float: left;\r\n    min-width: 75px;\r\n    line-height: 32px;\r\n    color: #969696;\r\n  }\r\n  li {\r\n    list-style: none;\r\n  }\r\n\r\n  .layer-bottom>div>div>ul>li>div:nth-child(2)>span {\r\n    display: inline-block;\r\n    color: #595959;\r\n    line-height: 32px;\r\n    height: 32px;\r\n  }\r\n\r\n  .layer-bottom>div>div>ul>li>div:nth-child(2)>input {\r\n    width: 172px;\r\n    height: 30px;\r\n    line-height: 30px\\9;\r\n    border: 1px solid #c8c8c8;\r\n    color: #595959;\r\n    padding: 0 14px;\r\n    border-radius: 3px;\r\n    font-size: 14px;\r\n    outline: none;\r\n  }\r\n  .layer-bottom>div>div>ul>li>div:nth-child(2)>input:focus {\r\n    border: 1px solid #4d90fe;\r\n  }\r\n  .layer-bottom>div>div>ul>li:nth-child(2)>div:nth-child(2)>b {\r\n    display: none;\r\n    line-height: 32px;\r\n    color: red;\r\n    font-size: 12px;\r\n    margin-left: 20px;\r\n    font-weight: 400;\r\n  }\r\n\r\n  .layer-bottom>div>div>ul>li:first-child>div:last-child {\r\n    float: right;\r\n    min-width: 56px;\r\n    height: 22px;\r\n    text-align: center;\r\n    line-height: 22px;\r\n    font-size: 12px;\r\n    border-radius: 3px;\r\n    margin-top: 3px;\r\n    padding-left: 5px;\r\n    padding-right: 5px;\r\n    cursor: pointer;\r\n    user-select: none;\r\n    color: #818181;\r\n    border: 1px solid #c8c8c8;\r\n    transition: .3s;\r\n  }\r\n\r\n  .layer-bottom>div>div:nth-child(1)>ul>li:first-child>div:last-child:hover,\r\n  .layer-bottom>div>div:nth-child(2)>ul>li:first-child>div:last-child:hover,\r\n  .layer-bottom>div>div:nth-child(3)>ul>li:first-child>div:last-child:hover {\r\n    color: #2d2d2d;\r\n    background: #e6e6e6;\r\n  }\r\n\r\n  .edit-box {\r\n    float: left;\r\n    position: relative;\r\n  }\r\n  .save-btn {\r\n    display: block;\r\n    margin-left: 75px;\r\n    width: 56px;\r\n    height: 26px;\r\n    border-radius: 3px;\r\n    background: #4d90fe;\r\n    color: #FFF;\r\n    text-align: center;\r\n    line-height: 26px;\r\n    margin-top: 10px;\r\n    cursor: pointer;\r\n    user-select: none;\r\n  }\r\n\r\n  /* 上传头像 */\r\n  .avatar-uploader {\r\n    position: absolute;\r\n    top: 45px;\r\n    color: #FFF;\r\n    background: rgba(0,0,0,.3);\r\n    transition: .5s ease;\r\n    font-size: 14px;\r\n    border-radius: 50%;\r\n    opacity: 0;\r\n  }\r\n  .avatar-uploader .el-upload {\r\n    border: 1px dashed #d9d9d9;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    overflow: hidden;\r\n  }\r\n  .el-upload>div {\r\n    height: 73px;\r\n    width: 73px;\r\n    border-radius: 50%;\r\n    line-height: 73px;\r\n    text-align: center;\r\n  }\r\n  .avatar-uploader-icon {\r\n    font-size: 28px;\r\n    color: #8c939d;\r\n    width: 73px;\r\n    height: 73px;\r\n    border-radius: 50%;\r\n    line-height: 73px;\r\n    text-align: center;\r\n  }\r\n</style>"]}]}